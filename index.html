<!doctype html>
<html lang="en" data-bs-theme="light">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lotus Grid</title>

    <link rel="icon" type="image/x-icon" href="./assets/img/LotusGridLogo.png">

    <!--Bootstrap Styles-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css">

    <!-- Tagify -->
    <link href="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.css" rel="stylesheet" type="text/css" />

    <!-- Other Styles -->
    <link rel="stylesheet" href="./assets/css/theme.css">
    <link rel="stylesheet" href="./assets/css/animations.css">
    <link rel="stylesheet" href="./assets/css/custom.css">
</head>

<body>
    <div class="d-flex">
        <nav class="sidebar d-flex flex-column flex-shrink-0 position-fixed collapsed bg-obsidian">
            <button class="toggle-btn" onclick="toggleSidebar()">
                <i class="bi bi-list"></i>
            </button>

            <div class="p-4 text-center">
                <img src="./assets/img/LotusGridLogo.png" alt="Logo" height="32" width="32">
            </div>

            <div class="nav flex-column">
                <a href="#" class="sidebar-link text-decoration-none p-3 rounded-0" id="darkToggle">
                    <span id="darkIcon">
                        <i class="bi bi-sun-fill"></i>
                    </span>
                    <span class="hide-on-collapse" id="darkIconText">Light</span>
                </a>
                <a href="#" class="sidebar-link text-decoration-none p-3 rounded-0" data-bs-toggle="collapse" data-bs-target="#inputCollapse" aria-expanded="true" aria-controls="inputCollapse">
                    <i class="bi bi-toggles"></i> <span class="hide-on-collapse">Hide Input</span>
                </a>
                <a href="#" class="sidebar-link text-decoration-none p-3 rounded-0" data-bs-toggle="modal" data-bs-target="#timerModal">
                    <i class="bi bi-stopwatch-fill"></i> <span class="hide-on-collapse">Timer</span>
                </a>

                <a href="#" class="sidebar-link text-decoration-none p-3 rounded-0" data-bs-toggle="modal" data-bs-target="#settingsModal">
                    <i class="bi bi-sliders"></i> <span class="hide-on-collapse">Settings</span>
                </a>
            </div>
        </nav>

        <main class="main-content flex-fill bg-body-secondary">
            <div class="container-fluid d-flex flex-column pe-0" id="appContainer">
                <div class="card flex-fill flex-row align-items-stretch rounded-0 collapse show mb-3" id="inputCollapse">
                    <div class="card-body d-flex flex-column col-10">
                        <div class="form-floating flex-fill">
                            <textarea class="form-control rounded-0" id="names" style="height: 100%;"></textarea>
                            <label for="floatingTextarea">Enter Names ...</label>
                        </div>
                    </div>
                    <div class="card-body d-grid gap-2 col-2">
                        <button class="btn btn-mystic-sapphire rounded-0" id="generateBtn" type="button"><i class="bi bi-shuffle"></i> Generate</button>
                        <button class="btn btn-mystic-sapphire rounded-0" id="saveBtn" type="button"><i class="bi bi-save"></i> Save</button>
                        <button class="btn btn-mystic-sapphire rounded-0" id="loadBtn" type="button"><i class="bi bi-folder2-open"></i> Load</button>
                        <button class="btn btn-mystic-sapphire rounded-0" id="clearBtn" type="button"><i class="bi bi-trash"></i> Clear</button>
                    </div>
                </div>
                <div id="output">
                    <div class="card flex-fill flex-column rounded-0">
                        <div class="card-header">
                            Instructions
                        </div>
                        <div class="card-body d-flex flex-row">
                            <div class="d-flex flex-column flex-fill">
                                <div class="d-flex flex-row flex-fill" role="tabpanel">
                                    <!-- List group -->
                                    <div class="list-group" id="myList" role="tablist">
                                        <a class="list-group-item list-group-item-action active rounded-0" data-bs-toggle="list" href="#nameIns" role="tab">Participants</a>
                                        <a class="list-group-item list-group-item-action rounded-0" data-bs-toggle="list" href="#tableIns" role="tab">Tables</a>
                                        <a class="list-group-item list-group-item-action rounded-0" data-bs-toggle="list" href="#locksIns" role="tab">Locks & Exceptions</a>
                                    </div>
                                    <!-- Tab panes -->
                                    <div class="flex-grow-1 tab-content ps-3">
                                        <div class="tab-pane active" id="nameIns" role="tabpanel">
                                            <div class="d-flex flex-column flex-fill">
                                                <div class="nameInstext">
                                                    <h5 class="card-title">Participants</h5>
                                                    <p>Enter participants ready to be seated into the input one per line <br> otherwise they will be treated as a single person.</p>
                                                </div>
                                                <div class="nameInsArea">
                                                    <div class="form-floating">
                                                        <textarea class="form-control" placeholder="Leave a comment here" id="textAreaInsDis" style="height: 100%; resize:none;" disabled>John&#10;Jim</textarea>
                                                        <label for="textAreaInsDis">Enter Names ...</label>
                                                    </div>                                        
                                                </div>
                                               <div class="nameInsArea">
                                                    <div class="form-floating mt-3">
                                                    <p>By default, all participants will be shuffled so that seating is random. <br>Duplicate names will also be removed. This behaviour can be changed in Settings under the below heading.</p>
                                                    </div>
                                                    <div class="accordion" id="accordion2Ins">
                                                        <div class="accordion-item">
                                                        <h2 class="accordion-header border">
                                                            <button class="accordion-button collapsed rounded-0" type="button" data-bs-toggle="collapse"
                                                            data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                                                            <span class="pe-2"><i class="bi bi-shuffle"></i></span>Shuffling & Duplication
                                                            </button>
                                                        </h2>
                                                        <div id="collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordion2Ins">
                                                            <div class="accordion-body p-0">
                                                            <ul class="list-group list-group-flush pt-1">
                                                                <li class="list-group-item">
                                                                <div class="form-check">
                                                                    <input class="form-check-input rounded-0" type="checkbox" id="shuffleSwitchIns" checked disabled>
                                                                    <label class="form-check-label" for="shuffleSwitchIns">Shuffle names on generate</label>
                                                                </div>
                                                                </li>
                                                                <li class="list-group-item">
                                                                <div class="form-check">
                                                                    <input class="form-check-input rounded-0" type="checkbox" id="dedupeSwitchIns" checked disabled>
                                                                    <label class="form-check-label" for="dedupeSwitchIns">Remove duplicate names</label>
                                                                </div>
                                                                </li>
                                                            </ul>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>                                        
                                                </div>                                                                                                   
                                            </div>
                                        </div>
                                        <div class="tab-pane" id="tableIns" role="tabpanel">
                                            <div class="d-flex flex-column flex-fill">
                                                <div class="tableInstext">
                                                    <h5 class="card-title">Tables</h5>
                                                    <p>Table seating is customisable. The default number of seats per table is 4. <br> This can be changed in Settings under the below heading.</p>
                                                </div>
                                                <div class="tableInsArea">
                                                    <div class="accordion" id="accordion1Ins">
                                                        <div class="accordion-item">
                                                        <h2 class="accordion-header border">
                                                            <button class="accordion-button collapsed rounded-0" type="button" data-bs-toggle="collapse"
                                                            data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                                                            <span class="pe-2"><i class="bi bi-ui-checks-grid"></i></span>Seats
                                                            </button>
                                                        </h2>
                                                        <div id="collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordion1Ins">
                                                            <div class="accordion-body p-1">
                                                            <ul class="list-group list-group-flush pt-1">
                                                                <li class="list-group-item p-1">
                                                                <div class="form-check p-0">
                                                                    <label for="seatsIns" class="form-label">Seats per table</label>
                                                                    <input id="seatsIns" type="number" class="form-control rounded-0" min="1" value="4" disabled>
                                                                </div>
                                                                </li>
                                                            </ul>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>                                                    
                                                </div>                                                
                                            </div>                                            
                                        </div>
                                        <div class="tab-pane" id="locksIns" role="tabpanel">
                                            <div class="lockInsText">
                                                <h5 class="card-title">Group Locking & Exceptions</h5>
                                                <p>Once you click generate - each person can be assigned a maximum of 3 exceptions. <br>
                                                Type their names into the exception box after 3 characters, all matches will appear as a dropdown item.</p>

                                                <p>You can also lock people to specific tables, select the table you want the participant to be seated at and then click the padlock. <br>
                                                Multiple groups can be assigned.</p>
                                            </div>
                                            <div class="lockInsArea" id="lockInsLock">
                                                <div class="card p-2 d-flex flex-row justify-content-between align-items-center rounded-0">
                                                    <span class="flex-fill me-3"><strong>Leeroy Jenkins</strong></span>
                                                    <div class="card p-2 d-flex flex-row justify content-between align-items-center rounded-0">
                                                        <div class="me-3 d-flex flex-row align-items-center flex-fill" title="Exclusions">
                                                        <label class="form-check-label px-2 ico-size" for="leeroyIns"><i class="bi bi-exclamation-octagon-fill"></i></label>
                                                        <input class="tag-input form-control rounded-0" id="leeroyIns" placeholder="Type names here..." disabled/>
                                                        </div>
                                                        <div class="form-check ms-0 me-3 ps-0 mb-0 d-flex flex-row align-items-center justify-content-center lock-check" title="Group Lock">
                                                        <input class="form-check-input group-lock-toggle rounded-0 d-none" type="checkbox" id="lockIns" disabled>
                                                        <label class="form-check-label ps-2 ico-size" for="lockIns"><i class="bi bi-unlock-fill"></i></label>
                                                        </div>
                                                        <div class="d-flex flex-row align-items-center" title="Set To Table">
                                                        <label for="tableIns" class="form-label me-2 mb-0 ico-size"><i class="bi bi-grid-3x3-gap-fill"></i></label>
                                                        <input type="number" class="form-control rounded-0" id="tableIns" value="1" min="1" max="10" title="Use arrows to select tables" disabled>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>    
        </main>

        <!-- Settings Modal -->
        <div class="modal fade" id="settingsModal" tabindex="-1">
            <div class="modal-dialog">
            <div class="modal-content rounded-0">
                <div class="modal-header">
                <h5 class="modal-title">Settings</h5><button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                <div class="accordion accordion-flush" id="accordionSettings">
                    <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#flush-collapseOne" aria-expanded="false" aria-controls="flush-collapseOne">
                        <span class="pe-2"><i class="bi bi-ui-checks-grid"></i></span>Seats
                        </button>
                    </h2>
                    <div id="flush-collapseOne" class="accordion-collapse collapse" data-bs-parent="#accordionSettings">
                        <div class="accordion-body p-1">
                        <ul class="list-group list-group-flush pt-1">
                            <li class="list-group-item p-1">
                            <div class="form-check p-0">
                                <label for="seatsPerTableInp" class="form-label">Seats per table</label>
                                <input id="seatsPerTableInp" type="number" class="form-control rounded-0" min="1" value="4">
                            </div>
                            </li>
                        </ul>
                        </div>
                    </div>
                    </div>
                    <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#flush-collapseTwo" aria-expanded="false" aria-controls="flush-collapseTwo">
                        <span class="pe-2"><i class="bi bi-shuffle"></i></span>Shuffling & Duplication
                        </button>
                    </h2>
                    <div id="flush-collapseTwo" class="accordion-collapse collapse" data-bs-parent="#accordionSettings">
                        <div class="accordion-body p-0">
                        <ul class="list-group list-group-flush pt-1">
                            <li class="list-group-item">
                            <div class="form-check">
                                <input class="form-check-input rounded-0" type="checkbox" id="shuffleSwitch" checked>
                                <label class="form-check-label" for="shuffleSwitch">Shuffle names on generate</label>
                            </div>
                            </li>
                            <li class="list-group-item">
                            <div class="form-check">
                                <input class="form-check-input rounded-0" type="checkbox" id="dedupeSwitch" checked>
                                <label class="form-check-label" for="dedupeSwitch">Remove duplicate names</label>
                            </div>
                            </li>
                        </ul>
                        </div>
                    </div>
                    </div>
                    <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#flush-collapseThree" aria-expanded="false" aria-controls="flush-collapseThree">
                        <span class="pe-2"><i class="bi bi-file-image-fill"></i></span>Animations
                        </button>
                    </h2>
                    <div id="flush-collapseThree" class="accordion-collapse collapse" data-bs-parent="#accordionSettings">
                        <div class="accordion-body p-1">
                        <ul class="list-group list-group-flush pt-1">
                            <li class="list-group-item p-1">
                            <div class="p-0 pb-1">
                                <label for="animStyle" class="form-label">Animation style</label>
                                <select id="animStyle" class="form-select rounded-0">
                                <option value="fade">Fade</option>
                                <option value="pop">Pop</option>
                                <option value="none">None</option>
                                </select>
                            </div>
                            </li>
                            <li class="list-group-item p-0 pt-1">
                            <div class="form-check p-1">
                                <label for="animSpeed" class="form-label">Animation speed</label>
                                <input id="animSpeed" type="range" min="0.5" max="2" step="0.1" value="1" class="form-range">
                                <div class="d-flex justify-content-between">
                                <small>0.5x</small><small id="animSpeedLabel">1x</small><small>2x</small>
                                </div>
                            </div>
                            </li>
                        </ul>
                        </div>
                    </div>
                    </div>
                    <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#flush-collapseFour" aria-expanded="false" aria-controls="flush-collapseFour">
                        <span class="pe-2"><i class="bi bi-alarm-fill"></i></span>Timer
                        </button>
                    </h2>
                    <div id="flush-collapseFour" class="accordion-collapse collapse" data-bs-parent="#accordionSettings">
                        <div class="accordion-body p-1">
                        <ul class="list-group list-group-flush pt-1">
                            <li class="list-group-item p-1">
                            <div class="form-check p-0">
                                <label for="timerLength" class="form-label">
                                Default Timer Length (minutes)
                                </label>
                                <input type="number" id="timerLength" class="form-control rounded-0" min="1" value="50">
                            </div>
                            </li>
                        </ul>
                        </div>
                    </div>
                    </div>
                    <div class="accordion-item">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#flush-collapseFive" aria-expanded="false" aria-controls="flush-collapseFive">
                        <span class="pe-2"><i class="bi bi-aspect-ratio-fill"></i></span>App Size
                        </button>
                    </h2>
                    </div>
                    <div id="flush-collapseFive" class="accordion-collapse collapse" data-bs-parent="#accordionSettings">
                    <div class="accordion-body p-1">
                        <ul class="list-group list-group-flush pt-1">
                        <li class="list-group-item p-1">
                            <div class="p-0 pb-1">
                            <label for="containerOptions">App Max Widths</label>
                            <ul class="list-group list-group-flush pt-1">
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                Option 1 <code>1140px</code>
                                <button type="button" class="btn btn-sm btn-mystic-sapphire rounded-0"
                                    data-size="xl">Set</button>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                Option 2 <code>1320px</code>
                                <button type="button" class="btn btn-sm btn-mystic-sapphire rounded-0"
                                    data-size="xxl">Set</button>
                                </li>
                                <li class="list-group-item d-flex justify-content-between align-items-center">
                                Option 3 <code>100% Width</code>
                                <button type="button" class="btn btn-sm btn-mystic-sapphire rounded-0"
                                    data-size="fluid">Set</button>
                                </li>
                            </ul>
                            </div>
                        </li>
                        </ul>
                    </div>
                    </div>            
                </div>
                </div>
                <div class="modal-footer"><button id="saveSettingsBtn" type="button" class="btn btn-mystic-sapphire rounded-0"
                    data-bs-dismiss="modal">Save Settings</button></div>
            </div>
            </div>
        </div>
        </div>

        <!-- Timer Modal -->
        <div class="modal fade" id="timerModal" tabindex="-1">
            <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content text-center rounded-0">
                <div class="modal-header">
                <h5 class="modal-title"><i class="bi bi-stopwatch"></i> Countdown Timer</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                <h1 id="timerDisplay" class="display-3 fw-bold">50:00</h1>
                <div class="d-flex justify-content-center gap-2 mt-3">
                    <button id="startPauseBtn" class="btn btn-mystic-sapphire rounded-0"><i class="bi bi-play-fill"></i>
                    Start</button>
                    <button id="resetBtn" class="btn btn-mystic-sapphire rounded-0"><i class="bi bi-arrow-counterclockwise"></i>
                    Reset</button>
                </div>
                </div>
            </div>
            </div>
        </div>

        <!-- Toasts -->
        <div class="toast-container position-fixed bottom-0 end-0 p-3">
            <div id="fullToast" class="toast text-bg-danger border-0">
            <div class="d-flex">
                <div class="toast-body">That table is full.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>
            <div id="saveToast" class="toast text-bg-success border-0">
            <div class="d-flex">
                <div class="toast-body">Layout saved.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>
            <div id="loadToast" class="toast text-bg-info border-0">
            <div class="d-flex">
                <div class="toast-body">Layout loaded.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>
            <div id="swapToast" class="toast text-bg-info border-0">
            <div class="d-flex">
                <div class="toast-body">Swap Mode Active: Drag and Drop to swap.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>
            <div id="emptyToast" class="toast text-bg-danger border-0">
            <div class="d-flex">
                <div class="toast-body">Enter at least one name.</div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>
            <div id="exceptionToast" class="toast text-bg-danger border-0">
            <div class="d-flex">
                <div class="toast-body">Could note seat: </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
            </div>
            </div>    
        </div>

        <!-- Groups & Exclusions Modal -->
        <div class="modal fade" id="groupLockModal" tabindex="-1" aria-labelledby="groupLockLabel" aria-hidden="true">
            <div class="modal-dialog modal-dialog-scrollable modal-fullscreen">
            <div class="modal-content rounded-0">
                <div class="modal-header">
                <h5 class="modal-title" id="groupLockLabel">Group Locks & Exclusions</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                <div id="groupLockList" class="row gy-2">
                    <!-- Dynamically populated -->
                </div>
                </div>
                <div class="modal-footer">
                <button class="btn btn-mystic-sapphire rounded-0" id="confirmGroupLock"
                    data-bs-dismiss="modal">Generate</button>
                </div>
            </div>
            </div>
        </div>

        <!-- Beep sound -->
        <audio id="beepSound">
            <source src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg" type="audio/ogg">
        </audio>

        <!-- Bootstrap Scripts -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

        <!-- SortableJS -->
        <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>

        <!-- Tagify -->
        <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify"></script>
        <script src="https://cdn.jsdelivr.net/npm/@yaireo/tagify/dist/tagify.polyfills.min.js"></script>

        <script src="./assets/js/dark-mode.js"></script>
        <script src="./assets/js/constants.js" type="module"></script>
        <script src="./assets/js/saved-settings.js" type="module"></script>
        <script src="./assets/js/timer.js"></script>
        <script src="./assets/js/table-generator.js" type="module"></script>
        <script src="./assets/js/drag-drop.js" type="module"></script>
        <script src="./assets/js/layout.js" type="module"></script>

        <script>
            function toggleSidebar() {
                const sidebar = document.querySelector('.sidebar');
                sidebar.classList.toggle('collapsed');
            }
        </script>
</body>

</html>